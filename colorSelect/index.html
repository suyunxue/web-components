<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>取色器</title>
    <link href="http://cdn.bootcss.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<body>

<div class="select-color-box">
    <canvas id="myCanvas" width="400" height="400"></canvas>
    <div class="contorl-color">
        <div class="colorSelect"></div>
        <div class="colorBar"></div>
    </div>

    <ul>
        <li class="input-group">
            <span class="input-group-addon">R</span>
            <input class="form-control">
            <div class="select-up"></div>
            <div class="select-down"></div>
        </li>
        <li class="input-group">
            <span class="input-group-addon">G</span>
            <input class="form-control">
            <div class="select-up"></div>
            <div class="select-down"></div>
        </li>
        <li class="input-group">
            <span class="input-group-addon>B</span>
            <input class="form-control">
            <div class="select-up"></div>
            <div class="select-down"></div>
        </li>
        <li class="input-group">
            <span class="input-group-addon">H</span>
            <input class="form-control">
            <div class="select-up"></div>
            <div class="select-down"></div>
        </li>
        <li class="input-group">
            <span class="input-group-addon">S</span>
            <input class="form-control">
            <div class="select-up"></div>
            <div class="select-down"></div>
        </li>
        <li class="input-group">
            <span class="input-group-addon">L</span>
            <input class="form-control">
            <div class="select-up"></div>
            <div class="select-down"></div>
        </li>
    </ul>
</div>

<script src="http://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="js/lib.js"></script>
<script src="js/main.js"></script>

<script>
    function fillColor() {
        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        var grd = ctx.createLinearGradient(0, 0, 0, 400);
        grd.addColorStop(0, 'rgba(0, 0, 0, 0)');
        grd.addColorStop(1, 'rgba(0, 0, 0, 1)');

        return {
            render: function (color) {
                ctx.clearRect(0, 0, 400, 400);

                var colorGradient = ctx.createLinearGradient(0, 0, 400, 0);
                colorGradient.addColorStop(0, 'white');
                colorGradient.addColorStop(1, color);

                ctx.fillStyle = colorGradient;
                ctx.fillRect(0, 0, 400, 400);

                ctx.fillStyle = grd;
                ctx.fillRect(0, 0, 400, 400);
            }
        }
    }

    function moveWithMouse() {
        var flag = false;
        var curY = 0;
        var offsetTop = $('.colorSelect').offset().top;

        $('.colorSelect').on('mousedown', function (e) {
            flag = true;
            curY = e.clientY;
        });

        $(document).on('mousemove', function (e) {
            if (flag) {
                var nowY = e.clientY;
                var disY = nowY - offsetTop;

                console.log('disY is: ' + disY);

                if (disY <= -6) {
                    disY = -6;
                } else if (disY >= 394) {
                    disY = 394;
                }

                $('.colorSelect').css('top', disY);
            }

        });

        $(document).on('mouseup', function (e) {
            flag = false;
        });

    }

    function init() {
        var wantFill = fillColor();
        wantFill.render('red');
        moveWithMouse();
    }

    init();

</script>

</body>
</html>